<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#007acc">
    <meta name="description" content="HPL IDE - H Programming Language é›†æˆå¼€å‘ç¯å¢ƒï¼Œæ”¯æŒ YAML æ ¼å¼è¯­æ³•çš„é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€">
    <title>HPL IDE - H Programming Language</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸš€</text></svg>">

    <!-- Monaco Editor -->
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs/loader.js" onerror="handleMonacoLoadError()"></script>
    <script>
        function handleMonacoLoadError() {
            var errorDiv = document.createElement('div');
            errorDiv.id = 'monaco-error-overlay';
            errorDiv.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #1e1e1e; color: #ccc; display: flex; align-items: center; justify-content: center; z-index: 9999; font-family: sans-serif;';
            errorDiv.innerHTML = '<div style="text-align: center; padding: 20px;"><h1 style="color: #f48771;">åŠ è½½å¤±è´¥</h1><p>æ— æ³•åŠ è½½ Monaco Editorã€‚è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–åˆ·æ–°é¡µé¢é‡è¯•ã€‚</p><button onclick="location.reload()" style="margin-top: 20px; padding: 10px 20px; cursor: pointer; background: #0e639c; color: white; border: none; border-radius: 3px;">åˆ·æ–°é¡µé¢</button></div>';
            if (document.body) {
                document.body.appendChild(errorDiv);
            } else {
                window.addEventListener('DOMContentLoaded', function() {
                    document.body.appendChild(errorDiv);
                });
            }
        }
    </script>

</head>

<body>
    <noscript>
        <div style="padding: 20px; text-align: center; font-family: sans-serif; background: #1e1e1e; color: #ccc; height: 100vh; display: flex; align-items: center; justify-content: center;">
            <div>
                <h1>éœ€è¦å¯ç”¨ JavaScript</h1>
                <p>HPL IDE éœ€è¦ JavaScript æ‰èƒ½æ­£å¸¸è¿è¡Œã€‚è¯·åœ¨æµè§ˆå™¨è®¾ç½®ä¸­å¯ç”¨ JavaScript ååˆ·æ–°é¡µé¢ã€‚</p>
            </div>
        </div>
    </noscript>
    <div id="app">

        <!-- å·¥å…·æ  -->
        <div class="toolbar">
            <div class="toolbar-left">
                <span class="logo">HPL IDE</span>
                <button type="button" id="btn-new" class="toolbar-btn" title="æ–°å»ºæ–‡ä»¶ (Ctrl+N)" aria-label="æ–°å»ºæ–‡ä»¶">
                    <span class="icon">ğŸ“„</span> æ–°å»º
                </button>
                <button type="button" id="btn-open" class="toolbar-btn" title="æ‰“å¼€æ–‡ä»¶ (Ctrl+O)" aria-label="æ‰“å¼€æ–‡ä»¶">
                    <span class="icon">ğŸ“‚</span> æ‰“å¼€
                </button>
                <button type="button" id="btn-save" class="toolbar-btn" title="ä¿å­˜æ–‡ä»¶ (Ctrl+S)" aria-label="ä¿å­˜æ–‡ä»¶">
                    <span class="icon">ğŸ’¾</span> ä¿å­˜
                </button>
                <div class="toolbar-separator"></div>
                <button type="button" id="btn-run" class="toolbar-btn run-btn" title="è¿è¡Œ (F5)" aria-label="è¿è¡Œç¨‹åº">
                    <span class="icon">â–¶ï¸</span> è¿è¡Œ
                </button>
                <div class="toolbar-separator"></div>
                <button type="button" id="btn-theme-toggle" class="toolbar-btn" title="åˆ‡æ¢ä¸»é¢˜" aria-label="åˆ‡æ¢ä¸»é¢˜">
                    <span class="icon" id="theme-icon">ğŸŒ™</span>
                </button>
                <button type="button" id="btn-font-decrease" class="toolbar-btn" title="å‡å°å­—ä½“" aria-label="å‡å°å­—ä½“">
                    <span class="icon">A-</span>
                </button>
                <button type="button" id="btn-font-increase" class="toolbar-btn" title="å¢å¤§å­—ä½“" aria-label="å¢å¤§å­—ä½“">
                    <span class="icon">A+</span>
                </button>
                <button type="button" id="btn-word-wrap" class="toolbar-btn" title="åˆ‡æ¢è‡ªåŠ¨æ¢è¡Œ" aria-label="åˆ‡æ¢è‡ªåŠ¨æ¢è¡Œ">
                    <span class="icon">â†©ï¸</span>
                </button>
                <button type="button" id="btn-shortcuts" class="toolbar-btn" title="å¿«æ·é”®å¸®åŠ© (Ctrl+K)" aria-label="å¿«æ·é”®å¸®åŠ©">
                    <span class="icon">âŒ¨ï¸</span>
                </button>
                <div class="toolbar-separator"></div>
                <button type="button" id="btn-config" class="toolbar-btn" title="è®¾ç½® (Ctrl+,)" aria-label="æ‰“å¼€è®¾ç½®">
                    <span class="icon">âš™ï¸</span> è®¾ç½®
                </button>

            </div>
            <div class="toolbar-right">
                <span id="status-indicator" class="status-ready">å°±ç»ª</span>
            </div>

        </div>

        <!-- ä¸»å†…å®¹åŒº -->
        <div class="main-container">
            <!-- æ–‡ä»¶èµ„æºç®¡ç†å™¨ -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <span class="sidebar-title">ğŸ“ æ–‡ä»¶èµ„æºç®¡ç†å™¨</span>
                    <button type="button" id="btn-refresh" class="icon-btn" title="åˆ·æ–°æ–‡ä»¶åˆ—è¡¨" aria-label="åˆ·æ–°æ–‡ä»¶åˆ—è¡¨">ğŸ”„</button>
                </div>
                <!-- æ–‡ä»¶æœç´¢æ¡† -->
                <div class="file-search-container">
                    <input type="text" id="file-search" class="file-search-input" placeholder="ğŸ” æœç´¢æ–‡ä»¶..." aria-label="æœç´¢æ–‡ä»¶">
                </div>
                <div class="file-tree" id="file-tree">
                    <div class="file-item loading">â³ åŠ è½½ä¸­...</div>
                </div>

            </div>


            <!-- ç¼–è¾‘å™¨åŒºåŸŸ -->
            <div class="editor-container">
                <!-- æ ‡ç­¾é¡µ -->
                <div class="tabs-container" id="tabs-container">
                    <div class="tab active" data-file="welcome">
                        <span class="tab-icon">ğŸ‘‹</span>
                        <span class="tab-title">æ¬¢è¿ä½¿ç”¨</span>
                    </div>
                </div>

                <!-- ç¼–è¾‘å™¨ -->
                <div class="editor-wrapper">
                    <div id="editor"></div>
                    <div id="welcome-page" class="welcome-page">
                        <div class="welcome-content">
                            <h1>ğŸš€ HPL IDE</h1>
                            <p class="subtitle">H Programming Language é›†æˆå¼€å‘ç¯å¢ƒ</p>
                            
                            <div class="welcome-section">
                                <h3>å¿«é€Ÿå¼€å§‹</h3>
                                <div class="quick-actions">
                                    <button class="action-btn" id="action-new">
                                        <span class="action-icon">ğŸ“„</span>
                                        <span>æ–°å»ºæ–‡ä»¶</span>
                                    </button>
                                    <button class="action-btn" id="action-open">
                                        <span class="action-icon">ğŸ“‚</span>
                                        <span>æ‰“å¼€æ–‡ä»¶</span>
                                    </button>
                                    <button class="action-btn" id="action-example">
                                        <span class="action-icon">ğŸ“‹</span>
                                        <span>æ‰“å¼€ç¤ºä¾‹</span>
                                    </button>
                                </div>
                            </div>

                            <div class="welcome-section" id="recent-files-section" style="display: none;">
                                <h3>æœ€è¿‘æ–‡ä»¶</h3>
                                <div class="recent-files-list" id="recent-files-list"></div>
                            </div>

                            <div class="welcome-section">
                                <h3>å…³äº HPL</h3>

                                <p>HPLï¼ˆH Programming Languageï¼‰æ˜¯ä¸€ç§åŸºäº YAML æ ¼å¼çš„é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ï¼Œä½¿ç”¨åŠ¨æ€ç±»å‹ã€‚</p>
                                <ul class="feature-list">
                                    <li>ğŸ“ YAML æ ¼å¼è¯­æ³•</li>
                                    <li>ğŸ—ï¸ é¢å‘å¯¹è±¡ï¼ˆç±»ã€ç»§æ‰¿ã€å¯¹è±¡ï¼‰</li>
                                    <li>ğŸ”„ æ§åˆ¶æµï¼ˆif/elseã€forã€whileï¼‰</li>
                                    <li>ğŸ“¦ æ ‡å‡†åº“æ¨¡å—ï¼ˆmathã€ioã€jsonã€osã€timeï¼‰</li>
                                    <li>âš¡ å†…ç½®å‡½æ•°ï¼ˆechoã€lenã€type ç­‰ï¼‰</li>
                                </ul>
                            </div>

                            <div class="welcome-section">
                                <h3>å¿«æ·é”®</h3>
                                <div class="shortcuts">
                                    <div class="shortcut"><kbd>Ctrl+N</kbd> æ–°å»ºæ–‡ä»¶</div>
                                    <div class="shortcut"><kbd>Ctrl+O</kbd> æ‰“å¼€æ–‡ä»¶</div>
                                    <div class="shortcut"><kbd>Ctrl+S</kbd> ä¿å­˜æ–‡ä»¶</div>
                                    <div class="shortcut"><kbd>Ctrl+F</kbd> æŸ¥æ‰¾</div>
                                    <div class="shortcut"><kbd>Ctrl+H</kbd> æŸ¥æ‰¾æ›¿æ¢</div>
                                    <div class="shortcut"><kbd>Ctrl+G</kbd> è·³è½¬åˆ°è¡Œ</div>
                                    <div class="shortcut"><kbd>F5</kbd> è¿è¡Œç¨‹åº</div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- åº•éƒ¨é¢æ¿ -->
        <div class="bottom-panel">

            <div class="panel-tabs">
                <div class="panel-tab active" data-panel="output">ğŸ“¤ è¾“å‡º</div>
                <div class="panel-tab" data-panel="problems">âš ï¸ é—®é¢˜</div>
            </div>
            <div class="panel-content">
                <div id="output-panel" class="output-panel">
                    <div class="output-header">
                        <div class="output-filters">
                            <button type="button" class="filter-btn active" data-filter="all" title="æ˜¾ç¤ºæ‰€æœ‰">å…¨éƒ¨</button>
                            <button type="button" class="filter-btn" data-filter="error" title="ä»…æ˜¾ç¤ºé”™è¯¯">âŒ é”™è¯¯</button>
                            <button type="button" class="filter-btn" data-filter="warning" title="ä»…æ˜¾ç¤ºè­¦å‘Š">âš ï¸ è­¦å‘Š</button>
                            <button type="button" class="filter-btn" data-filter="info" title="ä»…æ˜¾ç¤ºä¿¡æ¯">â„¹ï¸ ä¿¡æ¯</button>
                            <button type="button" class="filter-btn" data-filter="success" title="ä»…æ˜¾ç¤ºæˆåŠŸ">âœ… æˆåŠŸ</button>
                        </div>
                        <div class="output-actions">
                            <button type="button" id="btn-clear-output" class="icon-btn" title="æ¸…ç©ºè¾“å‡º" aria-label="æ¸…ç©ºè¾“å‡º">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                    <pre id="output-content" class="output-content"></pre>
                </div>
                <div id="problems-panel" class="problems-panel hidden">
                    <div class="problems-list" id="problems-list"></div>
                </div>
            </div>
        </div>

        <!-- çŠ¶æ€æ  -->
        <div class="statusbar">
            <div class="statusbar-left">
                <span id="file-info">æœªé€‰æ‹©æ–‡ä»¶</span>
                <span class="separator">|</span>
                <span id="cursor-info">è¡Œ 1, åˆ— 1</span>
            </div>
            <div class="statusbar-right">
                <span id="language-mode">HPL</span>
                <span class="separator">|</span>
                <span id="encoding">UTF-8</span>
            </div>
        </div>
    </div>

    <!-- éšè—çš„æ–‡ä»¶è¾“å…¥ -->
    <input type="file" id="file-input" accept=".hpl,.yaml,.yml" class="visually-hidden" aria-label="é€‰æ‹©HPLæ–‡ä»¶">

    <!-- ä¿å­˜æ–‡ä»¶å¯¹è¯æ¡† -->
    <div id="save-dialog" class="dialog hidden" role="dialog" aria-modal="true" aria-labelledby="save-dialog-title">
        <div class="dialog-content">
            <div class="dialog-header">
                <h3 id="save-dialog-title">ä¿å­˜æ–‡ä»¶</h3>
                <button type="button" class="dialog-close" id="btn-save-close" aria-label="å…³é—­å¯¹è¯æ¡†">Ã—</button>
            </div>
            <label for="save-filename">æ–‡ä»¶åï¼š</label>
            <input type="text" id="save-filename" placeholder="è¾“å…¥æ–‡ä»¶å (ä¾‹å¦‚: main.hpl)" required>
            <div class="dialog-buttons">
                <button type="button" id="btn-save-confirm" class="btn-primary">ä¿å­˜</button>
                <button type="button" id="btn-save-cancel">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <!-- é…ç½®å¯¹è¯æ¡† -->
    <div id="config-dialog" class="dialog hidden" role="dialog" aria-modal="true" aria-labelledby="config-dialog-title">
        <div class="dialog-content">
            <div class="dialog-header">
                <h3 id="config-dialog-title">IDE è®¾ç½®</h3>
                <button type="button" class="dialog-close" id="btn-config-close" aria-label="å…³é—­å¯¹è¯æ¡†">Ã—</button>
            </div>
            <div class="config-form">
                <div class="config-item">
                    <label for="config-api-url">åç«¯æœåŠ¡å™¨åœ°å€:</label>
                    <input type="url" id="config-api-url" placeholder="http://localhost:5000" required>
                </div>
                <div class="config-item">
                    <label for="config-timeout">è¯·æ±‚è¶…æ—¶ (æ¯«ç§’):</label>
                    <input type="number" id="config-timeout" placeholder="7000" min="5000" max="120000" required>
                </div>
                <div class="config-item">
                    <label for="config-font-size">ç¼–è¾‘å™¨å­—ä½“å¤§å°:</label>
                    <input type="number" id="config-font-size" placeholder="14" min="8" max="32" required>
                </div>
                <div class="config-item">
                    <label for="config-theme">ç¼–è¾‘å™¨ä¸»é¢˜:</label>
                    <select id="config-theme">
                        <option value="vs-dark">æ·±è‰² (vs-dark)</option>
                        <option value="vs">æµ…è‰² (vs)</option>
                        <option value="hc-black">é«˜å¯¹æ¯”åº¦ (hc-black)</option>
                    </select>
                </div>
                <div class="config-item checkbox-item">
                    <label for="config-auto-save" class="checkbox-label">
                        <input type="checkbox" id="config-auto-save">
                        <span>å¯ç”¨è‡ªåŠ¨ä¿å­˜</span>
                    </label>
                </div>
            </div>
            <div class="dialog-buttons">
                <button type="button" id="btn-test-connection" class="btn-secondary">æµ‹è¯•è¿æ¥</button>
                <button type="button" id="btn-config-reset" class="btn-secondary">é‡ç½®</button>
                <button type="button" id="btn-config-save" class="btn-primary">ä¿å­˜</button>
                <button type="button" id="btn-config-cancel">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <!-- å¿«æ·é”®å¸®åŠ©å¯¹è¯æ¡† -->
    <div id="shortcuts-dialog" class="dialog hidden" role="dialog" aria-modal="true" aria-labelledby="shortcuts-dialog-title">
        <div class="dialog-content shortcuts-dialog-content">
            <div class="dialog-header">
                <h3 id="shortcuts-dialog-title">âŒ¨ï¸ å¿«æ·é”®å‚è€ƒ</h3>
                <button type="button" class="dialog-close" id="btn-shortcuts-close" aria-label="å…³é—­å¯¹è¯æ¡†">Ã—</button>
            </div>
            <div class="shortcuts-container">
                <div class="shortcuts-category">
                    <h4>æ–‡ä»¶æ“ä½œ</h4>
                    <div class="shortcut-item"><kbd>Ctrl+N</kbd> <span>æ–°å»ºæ–‡ä»¶</span></div>
                    <div class="shortcut-item"><kbd>Ctrl+O</kbd> <span>æ‰“å¼€æ–‡ä»¶</span></div>
                    <div class="shortcut-item"><kbd>Ctrl+S</kbd> <span>ä¿å­˜æ–‡ä»¶</span></div>
                </div>
                <div class="shortcuts-category">
                    <h4>ç¼–è¾‘</h4>
                    <div class="shortcut-item"><kbd>Ctrl+F</kbd> <span>æŸ¥æ‰¾</span></div>
                    <div class="shortcut-item"><kbd>Ctrl+H</kbd> <span>æŸ¥æ‰¾æ›¿æ¢</span></div>
                    <div class="shortcut-item"><kbd>Ctrl+G</kbd> <span>è·³è½¬åˆ°è¡Œ</span></div>
                    <div class="shortcut-item"><kbd>Ctrl+Z</kbd> <span>æ’¤é”€</span></div>
                    <div class="shortcut-item"><kbd>Ctrl+Y</kbd> <span>é‡åš</span></div>
                </div>
                <div class="shortcuts-category">
                    <h4>è¿è¡Œ</h4>
                    <div class="shortcut-item"><kbd>F5</kbd> <span>è¿è¡Œç¨‹åº</span></div>
                </div>
                <div class="shortcuts-category">
                    <h4>è®¾ç½®</h4>
                    <div class="shortcut-item"><kbd>Ctrl+,</kbd> <span>æ‰“å¼€è®¾ç½®</span></div>
                    <div class="shortcut-item"><kbd>Ctrl+K</kbd> <span>å¿«æ·é”®å¸®åŠ©</span></div>
                </div>
            </div>
            <div class="dialog-buttons">
                <button type="button" id="btn-shortcuts-ok" class="btn-primary">ç¡®å®š</button>
            </div>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/editor.js"></script>
    <script src="js/api.js"></script>
    <script src="js/fileManager.js"></script>
    <script src="js/app.js"></script>

</body>
</html>
